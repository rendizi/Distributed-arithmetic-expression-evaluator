**`DAEE`**

<h2>Установка, настройка и запуск</h2>
Для начала установите себе postgresql и настройте его, добавьте ваши данные в src/backend/daee/db/db.go в константные значения(а точнее измените их). 

После установки с помощью приложения от имени администратора пропишите:
```
 cd "C:\Program Files\PostgreSQL\16\bin"
& "C:\Program Files\PostgreSQL\16\bin\psql.exe" -U "ваше имя пользователя postgresql(без кавычек)"
```
Введите свой пароль и пропишите 
```
    CREATE DATABASE golang_microservice;
    \l
    \q
```


В проекте имеется 3 main файла:
- src/frontend/main.go для запуска вебсайта
- src/backend/daee/cmd/main.go для запуска главного сервера
- src/backend/machines/cmd/main.go для запуска вычислительных машин

Для запуска всего проекта нужно запустить три main файла соответственно:
```
go run src/frontend/main.go
go run src/backend/daee/cmd/main.go
go run src/backend/machines/cmd/main.go
```
<h2>Вебсайт</h2>
Вебсайт работает на порту 8079, перейти к нему можно по ссылке http://127.0.0.1:8079/ . 


<p align="center">
    <img src="https://github.com/rendizi/Distributed-arithmetic-expression-evaluator/assets/120701599/cc0f3169-4b17-4eba-a251-eeb3e5305747">
</p>



Кнопки:
- При нажатии на кнопку Expressions можно получить список всех запросов от UID , 
который можно изменить ниже , и информация о них. 
- Кнопка Operations показывает все незавершенные операции и айди отправителя запроса.
- Кнопка Machines отображает список всех активных вычислительных машин 
и время, когда их последний раз пинговали. 


Чуть ниже имеется отправитель запросов на вычисления выражения:
- UID- айди юзера, отправляющий запрос, через который можно будет в Expressions увидеть историю запросов.
- Task- само задание,
важное замечание что между всеми символами должен быть пробел.
- Настройки- время, за которое должна вычислятся каждая операция (1 - умножение, 2 - деление, 3 - сумма, 4 - разность), перечисляться через запятую,
измеряются в секундах.

<h2>Главный сервер</h2>
Главный сервер слушает на порту 8080 и хэндлит следующие запросы:

- expression (POST&GET), добавляющий новое выражение в бд и очередь при запросе POST, возвращает список выражений отправленные юзером при запросе GET. Примеры curl запросов следующие:
```
    curl -X POST "http://127.0.0.1:8080/expression?uid=1&task=2%20%2B%202%20%2A%202&settings=1%2c1%2c1%2c1"
    curl -X GET "http://127.0.0.1:8080/expression?id=1"
```
Может показаться непонятным запрос POST, вообщем, тут есть особенности енкодинга- плюс это %2B, минус это %2D, умножить это %2A, делить это %2F, пробел это %20, запятая это %2C, иначе выйдет ошибка curl: (3) URL rejected: Malformed input to a URL function
- operations (GET), возвращающий операции
  ```
  curl -X GET "http://127.0.0.1:8080/operations"
  ```
- reg , регистрирующий вычислительную машину
  ```
  curl -X POST "http://127.0.0.1:8080/reg?name=supercomputer&port=8090"
  ```
- task (POST&GET), возвращающий любое задание при запросе GET или добавляющий ответ к заданию при запросе POST.
  ```
  curl -X GET "http://127.0.0.1:8080/task?id=1"
  curl -X POST "http://127.0.0.1:8080/task?id=1&task=2%20%2B%202%20%2A%202&answ=6&time=2s"
  ```
- machines , возвращающий список вычислительных машин
  ```
  curl -X GET "http://127.0.0.1:8080/machines"
  ```

  
<h2>Вычислительные машины</h2>

Вычислительная машина работает на порте 8081 , ее также можно пингануть:
```
curl -X GET "http://127.0.0.1:8081/"
```



